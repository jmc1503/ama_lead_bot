<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AMA Lead Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      color-scheme: light dark;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      max-width: 720px;
      margin: 2rem auto;
      padding: 0 1rem 3rem;
      line-height: 1.5;
    }

    header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    header img {
      height: 40px;
      width: auto;
      border-radius: 8px;
    }

    h1 {
      margin: 0;
      font-size: 1.6rem;
    }

    p.subtitle {
      margin: 0.15rem 0 0;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    form {
      display: grid;
      gap: 1rem;
    }

    label {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
      font-size: 0.9rem;
      font-weight: 600;
    }

    input,
    select,
    textarea,
    button {
      font: inherit;
      padding: 0.45rem 0.55rem;
      border-radius: 6px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.02);
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #1d9bf0;
      box-shadow: 0 0 0 1px rgba(29, 155, 240, 0.5);
      background: rgba(15, 23, 42, 0.01);
    }

    textarea {
      min-height: 100px;
      resize: vertical;
      white-space: pre-wrap;
    }

    .field-hint {
      font-size: 0.8rem;
      font-weight: 400;
      opacity: 0.7;
    }

    .field-row {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    .field-row > label {
      flex: 1 1 160px;
    }

    .section-heading {
      margin-top: 0.75rem;
      font-size: 0.85rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      opacity: 0.8;
    }

    .optional-group {
      border: 1px solid rgba(148, 163, 184, 0.6);
      border-radius: 10px;
      padding: 0.65rem 0.75rem 0.75rem;
      display: grid;
      gap: 0.6rem;
    }

    .optional-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.85rem;
    }

    .optional-header-main {
      font-weight: 600;
    }

    .optional-toggle {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      font-weight: 500;
    }

    .optional-toggle input[type="checkbox"] {
      width: auto;
      accent-color: #1d9bf0;
    }

    .optional-body {
      display: grid;
      gap: 0.6rem;
    }

    .checkbox-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      font-size: 0.85rem;
    }

    .checkbox-row label {
      flex-direction: row;
      align-items: center;
      gap: 0.35rem;
      font-weight: 500;
    }

    .checkbox-row input[type="checkbox"] {
      width: auto;
      accent-color: #1d9bf0;
    }

    .risk-select {
      max-width: 120px;
    }

    button[type="submit"] {
      margin-top: 0.5rem;
      cursor: pointer;
      background: #1d9bf0;
      color: white;
      border: none;
      font-weight: 600;
      padding: 0.6rem 0.95rem;
      border-radius: 999px;
      justify-self: flex-start;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
    }

    button[type="submit"]:hover:not(:disabled) {
      filter: brightness(1.05);
    }

    button[type="submit"]:disabled {
      opacity: 0.6;
      cursor: default;
    }

    .status {
      margin-top: 0.75rem;
      font-size: 0.85rem;
      min-height: 1em;
    }

    .status.error {
      color: #dc2626;
    }

    .status.success {
      color: #16a34a;
    }

    @media (max-width: 520px) {
      body {
        margin-top: 1.25rem;
      }

      header {
        flex-direction: column;
        align-items: flex-start;
      }

      h1 {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <img src="images/logo.png" alt="AMA logo" />
    <div>
      <h1>AMA Lead Console</h1>
      <p class="subtitle">Standardise lead posts across Sneakers, Collectibles, Electronics and more.</p>
    </div>
  </header>

  <form id="leadForm" autocomplete="off">
    <!-- Lead meta -->
    <div class="field-row">
      <label>
        Lead type
        <select name="leadType" required>
          <option value="">Select type…</option>
          <option value="sneakers">Sneakers</option>
          <option value="collectibles">Collectibles</option>
          <option value="electronics">Electronics</option>
          <option value="high_risk">High-Risk Flip</option>
          <option value="general">General</option>
        </select>
        <span class="field-hint">Controls channel, embed colour, and role ping.</span>
      </label>

      <label>
        Title
        <input
          type="text"
          name="title"
          required
          minlength="3"
          maxlength="150"
          placeholder='e.g. Nike Kobe 6 Protro "Total Orange" – SNKRS UK'
        />
        <span class="field-hint">What members see as the lead title.</span>
      </label>
    </div>

    <div class="section-heading">Core details</div>

    <!-- Pricing -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">RRP / Resell & profit</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includePricing" checked />
          Include
        </label>
      </div>
      <div class="optional-body field-row">
        <label>
          RRP (£)
          <input
            type="text"
            name="rrp"
            inputmode="decimal"
            placeholder="e.g. 165"
          />
        </label>
        <label>
          Resell (£)
          <input
            type="text"
            name="resellPrice"
            inputmode="decimal"
            placeholder="e.g. 220"
          />
        </label>
        <span class="field-hint">If included, both RRP and resell are required – profit is auto-calculated.</span>
      </div>
    </div>

    <!-- Drop date -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Drop date</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includeDropDate" checked />
          Include
        </label>
      </div>
      <div class="optional-body field-row">
        <label>
          Drop date / time
          <input
            type="text"
            name="dropDate"
            maxlength="80"
            placeholder="e.g. 28 Nov, 8am UK"
          />
        </label>
        <label class="optional-toggle">
          <input type="checkbox" name="liveNow" />
          Live now
        </label>
        <span class="field-hint">Tick "Live now" if it’s already available instead of a future date.</span>
      </div>
    </div>

    <!-- Lead location -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Lead location</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includeLeadLocation" checked />
          Include
        </label>
      </div>
      <div class="optional-body">
        <label>
          URL or store name
          <input
            type="text"
            name="leadLocation"
            maxlength="160"
            placeholder="e.g. Nike SNKRS UK or https://www.nike.com/..."
          />
          <span class="field-hint">Can be a store name or a direct product URL.</span>
        </label>
      </div>
    </div>

    <!-- Resell platforms -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Resell platforms</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includePlatforms" checked />
          Include
        </label>
      </div>
      <div class="optional-body">
        <div class="checkbox-row">
          <label>
            <input type="checkbox" name="platform_ebay" />
            eBay
          </label>
          <label>
            <input type="checkbox" name="platform_facebook" />
            Facebook Marketplace
          </label>
          <label>
            <input type="checkbox" name="platform_stockx" />
            StockX
          </label>
          <label>
            <input type="checkbox" name="platform_goat" />
            GOAT
          </label>
        </div>
        <span class="field-hint">Tick one or more platforms where you expect flips to work.</span>
      </div>
    </div>

    <!-- Sold listings -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Sold listings URL</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includeSoldListings" />
          Include
        </label>
      </div>
      <div class="optional-body">
        <label>
          Sold listings URL
          <input
            type="text"
            name="soldListingsUrl"
            maxlength="300"
            placeholder="e.g. https://www.ebay.co.uk/sch/i.html?...&LH_Sold=1"
          />
        </label>
      </div>
    </div>

    <!-- Description -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Description</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includeDescription" checked />
          Include
        </label>
      </div>
      <div class="optional-body">
        <label>
          Description
          <textarea
            name="description"
            maxlength="1500"
            placeholder="Sizes, notes, stock insights, fees, timing etc."
          ></textarea>
        </label>
      </div>
    </div>

    <!-- Risk rating -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Risk rating</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includeRiskRating" checked />
          Include
        </label>
      </div>
      <div class="optional-body">
        <label>
          Risk (1–5)
          <select name="riskRating" class="risk-select">
            <option value="">Select…</option>
            <option value="1">1 – Very low</option>
            <option value="2">2 – Low</option>
            <option value="3">3 – Medium</option>
            <option value="4">4 – High</option>
            <option value="5">5 – Very high</option>
          </select>
          <span class="field-hint">1 = safest, 5 = highest risk / more speculative.</span>
        </label>
      </div>
    </div>

    <!-- Returns -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Returns info</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includeReturns" />
          Include
        </label>
      </div>
      <div class="optional-body">
        <label>
          Returns info
          <textarea
            name="returnsInfo"
            maxlength="500"
            placeholder="e.g. 30-day free returns, outlet credit only, no returns on sale items etc."
          ></textarea>
        </label>
      </div>
    </div>

    <!-- Misc -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Misc (discount codes, cashback, notes)</span>
        <label class="optional-toggle">
          <input type="checkbox" name="includeMisc" />
          Include
        </label>
      </div>
      <div class="optional-body">
        <label>
          Misc
          <textarea
            name="miscInfo"
            maxlength="500"
            placeholder="Discount codes, cashback %, stacking tricks, alerts etc."
          ></textarea>
        </label>
      </div>
    </div>

    <!-- Image -->
    <div class="optional-group">
      <div class="optional-header">
        <span class="optional-header-main">Image URL</span>
        <span class="field-hint">Optional – if provided, will show as embed image.</span>
      </div>
      <div class="optional-body">
        <label>
          Image URL
          <input
            type="text"
            name="imageUrl"
            maxlength="400"
            placeholder="Direct image link (https://...)"
          />
        </label>
      </div>
    </div>

    <!-- Staff password -->
    <label>
      Staff password
      <input
        type="password"
        name="authKey"
        required
        placeholder="Shared console password"
      />
      <span class="field-hint">Prevents randoms from posting if they find the link.</span>
    </label>

    <button type="submit">
      <span>Post lead</span>
      <span aria-hidden="true">↗︎</span>
    </button>

    <div id="status" class="status"></div>
  </form>

  <script>
    const form = document.getElementById('leadForm');
    const statusEl = document.getElementById('status');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      statusEl.textContent = '';
      statusEl.className = 'status';

      const formData = new FormData(form);
      const payload = Object.fromEntries(formData.entries());

      const submitButton = form.querySelector('button[type="submit"]');
      submitButton.disabled = true;

      try {
        const res = await fetch('/.netlify/functions/post-lead', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
        });

        let data = {};
        try {
          data = await res.json();
        } catch (_) {}

        if (!res.ok) {
          statusEl.textContent = data.error || 'Failed to post lead.';
          statusEl.classList.add('error');
        } else {
          statusEl.textContent = data.message || 'Lead posted successfully.';
          statusEl.classList.add('success');
          form.reset();
        }
      } catch (err) {
        console.error(err);
        statusEl.textContent = 'Network error posting lead.';
        statusEl.classList.add('error');
      } finally {
        submitButton.disabled = false;
      }
    });
  </script>
</body>
</html>